/**
 * SkyWay-Screenshare-Library - Screenshare Library for SkyWay
 * @version v1.0.0
 * @author NTT Communications(skyway@ntt.com)
 * @link https://github.com/nttcom/SkyWay-ScreenShare
 * @license MIT License
 */
var SkyWay;!function(e){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;var i=function(){function e(e){"undefined"==typeof e&&(e=null),this._debug=!1,null!==e&&"debug"in e&&(this._debug=e.debug)}return e.prototype.startScreenShare=function(e,i,t,n){var a=this;if("undefined"==typeof n&&(n=null),navigator.mozGetUserMedia){var r={video:{mozMediaSource:"window",mediaSource:"window"},audio:!1};isFinite(e.Width)&&(r.video.width={min:e.Width,max:e.Width}),isFinite(e.Height)&&(r.video.height={min:e.Height,max:e.Height}),isFinite(e.FrameRate)&&(r.video.frameRate={min:e.FrameRate,max:e.FrameRate}),this.logger(r),navigator.mozGetUserMedia(r,function(e){a.logger(e),i(e)},function(e){a.logger(e),t(e)})}else if(navigator.webkitGetUserMedia){var o={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:""},optional:[{googTemporalLayeredScreencast:!0},{googLeakyBucket:!0}]};isFinite(e.Width)&&(o.mandatory.maxWidth=e.Width,o.mandatory.minWidth=e.Width),isFinite(e.Height)&&(o.mandatory.maxHeight=e.Height,o.mandatory.minHeight=e.Height),isFinite(e.FrameRate)&&(o.mandatory.maxFrameRate=e.FrameRate,o.mandatory.minFrameRate=e.FrameRate),window.addEventListener("message",function(e){a.logger(e.data.type),"gotStreamId"==e.data.type&&(o.mandatory.chromeMediaSourceId=e.data.streamid,a.logger(o),navigator.getUserMedia({audio:!1,video:o},function(e){e.onended=function(e){a.logger(e),"undefined"!=typeof n&&null!==n&&n()},a.logger(e),i(e)},function(e){a.logger(e),t(e)}))}),window.postMessage({type:"getStreamId"},"*")}else if(AdapterJS&&AdapterJS.WebRTCPlugin&&AdapterJS.WebRTCPlugin.isPluginInstalled){var d={video:{optional:[{sourceId:AdapterJS.WebRTCPlugin.plugin.screensharingKey||"Screensharing"}]},audio:!1};AdapterJS.WebRTCPlugin.callWhenPluginReady(function(){if(!AdapterJS.WebRTCPlugin.plugin.HasScreensharingFeature||!AdapterJS.WebRTCPlugin.plugin.isScreensharingAvailable)throw new Error("Your WebRTC plugin does not support screensharing");navigator.getUserMedia(d,function(e){e.onended=function(e){a.logger(e),"undefined"!=typeof n&&n()},a.logger(e),i(e)},function(e){a.logger(e),t(e)})})}},e.prototype.stopScreenShare=function(){return!1},e.prototype.isEnabledExtension=function(){return"boolean"==typeof window.ScreenShareExtentionExists||AdapterJS&&AdapterJS.WebRTCPlugin&&AdapterJS.WebRTCPlugin.isPluginInstalled?(this.logger("ScreenShare Extension available"),!0):(this.logger("ScreenShare Extension not available"),!1)},e.prototype.logger=function(e){this._debug&&console.log("ScreenShare: "+e)},e}();e.ScreenShare=i}(SkyWay||(SkyWay={}));