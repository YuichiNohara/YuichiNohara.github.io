<!DOCTYPE html>
<HTML>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="Content-Script-Type" content="text/javascript">

<script type="text/javascript">
var log=null;

var midi = null;			// global MIDIAccess object
var input=null;
var outputs=null;

function onMIDISuccess( midiAccess ) {

	midi = midiAccess;		// store in the global (in real usage, would probably keep in an object instance)

//	inputs=midi.inputs();
//	outputs=midi.outputs();

	if (typeof midi.inputs === "function") {
		inputs=midi.inputs();
		outputs=midi.outputs();
	} else {
		var inputIterator = midi.inputs.values();
		inputs = [];
		for (var o = inputIterator.next(); !o.done; o = inputIterator.next()) {
			inputs.push(o.value)
		}
		var outputIterator = midi.outputs.values();
		outputs = [];
		for (var o = outputIterator.next(); !o.done; o = outputIterator.next()) {
			outputs.push(o.value)
		}
	}

	log.innerText += "MIDI ready!";
		log.innerText +="\n";
	log.innerText +="input_device=";
		log.innerText += inputs.length;
		log.innerText +="\n";
	log.innerText +="output_device=";
		log.innerText += outputs.length;
		log.innerText +="\n";
}

function onMIDIFailure(msg) {
	alert( "Failed to get MIDI access - " + msg );
}

function runTest() {
	if (!log)
		log = document.getElementById("log");
	navigator.requestMIDIAccess().then( onMIDISuccess, onMIDIFailure );
}

</script>
</head>
<body>
<table border="2">
<caption>Web MIDI Check</caption>
<tr><td><div id="sans"> request MIDI Access Monitor </div></td></tr>
<tr><td><pre id="log"></pre></td></tr>
<script>runTest();</script>
</body>
</html>

